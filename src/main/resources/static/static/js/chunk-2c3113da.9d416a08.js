(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c3113da"],{"1db2":function(t,e,a){"use strict";a("5392")},"2ea8":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container calendar-list-container"},[a("el-row",[a("el-form",{staticClass:"search-form",attrs:{"label-width":"70px","label-position":"left",size:"small",inline:!0}},[a("el-form-item",{attrs:{label:"年度"}},[a("select-year",{on:{change:t.handleChangeYear}})],1),t._v(" "),a("el-form-item",{attrs:{label:"任务类型"}},[a("el-select",{attrs:{clearable:"",size:"small",placeholder:"请选择"},model:{value:t.searchData.task_type,callback:function(e){t.$set(t.searchData,"task_type",e)},expression:"searchData.task_type"}},t._l(t.options.taskType,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"任务状态"}},[a("el-select",{attrs:{clearable:"",size:"small",placeholder:"请选择"},model:{value:t.searchData.task_state,callback:function(e){t.$set(t.searchData,"task_state",e)},expression:"searchData.task_state"}},t._l(t.options.taskState,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),a("el-form-item",[a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"search"},on:{click:t.handleQuery}},[t._v("搜索")])],1),t._v(" "),t.ui.showTable?a("el-form-item",{staticClass:"fr show-text"},[a("span",[t._v("共计："+t._s(t.table.result.task_total)+"个")])]):t._e()],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"tree-card",attrs:{shadow:"never"}},[a("el-tabs",{on:{"tab-click":t.handleTreeTabClick},model:{value:t.current.treeTab,callback:function(e){t.$set(t.current,"treeTab",e)},expression:"current.treeTab"}},[a("el-tab-pane",{attrs:{label:"部门",name:"dept"}},[a("el-tree",{attrs:{data:t.tree.dept.data,props:t.tree.dept.props,"node-key":"id","expand-on-click-node":!1},on:{"node-click":t.getTableData}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"任务分类",name:"task"}},[a("el-tree",{attrs:{data:t.tree.task.data,props:t.tree.task.props,"node-key":"id","expand-on-click-node":!1},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.node,s=e.data;return a("span",{staticClass:"custom-tree-node",on:{click:function(e){return t.getTableData(s)}}},[a("span",[t._v(t._s(l.label))])])}}])})],1)],1)],1)]),t._v(" "),t.ui.showTable?a("el-col",{attrs:{span:20}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{staticClass:"fr show-text"},[a("span",{staticStyle:{"margin-left":"20px"}},[t._v("正在作业中："+t._s(t.table.result.task_doing)+"幅")]),t._v(" "),a("span",{staticStyle:{"margin-left":"20px"}},[t._v("进厂："+t._s(t.table.result.task_enter)+"幅")])])],1),t._v(" "),a("table-layout",{attrs:{"page-size":t.searchData.page_size,total:t.table.page.recordCount},on:{"page-change":t.handleCurrentChange}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.table.loading,expression:"table.loading"}],staticStyle:{width:"100%"},attrs:{data:t.table.data,"highlight-current-row":"",border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"task_name",label:"任务名称",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"task_type",label:"任务类型",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"task_class_tag",label:"图书名称",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"task_type_content",label:"添印/改版",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"task_start_date",label:"下达时间",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"进度"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{size:"medium"},on:{click:function(a){return t.handleOpenProgressDialog(e.row)}}},[t._v("查看")])]}}],null,!1,4080893389)}),t._v(" "),a("el-table-column",{attrs:{prop:"task_print_date",label:"进厂时间",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"详情"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{size:"medium"},on:{click:function(a){return t.handleOpenDetailDialog(e.row)}}},[t._v("查看")])]}}],null,!1,110901921)}),t._v(" "),a("el-table-column",{attrs:{prop:"task_state",label:"状态",width:"100"}})],1)],1)],1):t._e()],1),t._v(" "),a("el-dialog",{attrs:{title:"人员与进度信息浏览",visible:t.dialog.progress.visible,width:"610px"},on:{"update:visible":function(e){return t.$set(t.dialog.progress,"visible",e)}}},[a("div",{staticStyle:{"margin-bottom":"20px"}},[t._v("\n    产品类型：\n    "),a("el-radio-group",{on:{change:t.distributionTypeChange},model:{value:t.dialog.progress.distribution_type,callback:function(e){t.$set(t.dialog.progress,"distribution_type",e)},expression:"dialog.progress.distribution_type"}},t._l(t.chartProductType,(function(e){return a("el-radio",{key:e,attrs:{label:e}},[t._v("\n        "+t._s(e)+"\n      ")])})),1)],1),t._v(" "),a("el-table",{attrs:{border:"",data:t.dialog.progress.data}},[a("el-table-column",{attrs:{property:"user_duty",label:"过程"}}),t._v(" "),a("el-table-column",{attrs:{property:"user_name",label:"人员"}}),t._v(" "),a("el-table-column",{attrs:{property:"work_days",label:"工天"}}),t._v(" "),a("el-table-column",{attrs:{property:"start_date",label:"开始时间"}}),t._v(" "),a("el-table-column",{attrs:{property:"end_date",label:"结束时间"}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"任务详情",visible:t.dialog.detail.visible,width:"800px"},on:{"update:visible":function(e){return t.$set(t.dialog.detail,"visible",e)}}},[a("el-table",{attrs:{border:"",data:t.dialog.detail.data}},[a("el-table-column",{attrs:{width:"100",property:"date",label:"库存"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"user_name",label:"作业员"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"address",label:"校对"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"date",label:"编辑"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"name",label:"验收"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"address",label:"任务量"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"date",label:"紧急量"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"name",label:"改版申请"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"address",label:"图例表"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"address",label:"比例尺"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"date",label:"出版时间"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"name",label:"版次"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"address",label:"附加信息1"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",property:"address",label:"附加信息2"}})],1)],1)],1)},s=[],r=(a("ac67"),a("1bc7"),a("32ea"),a("a450"),a("28f8")),i=a("18ed"),n=a("ada5"),o=a("b199"),d=a("6797"),c=a("857b");function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,l)}return a}function b(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var u={components:{SelectYear:i["a"],TableLayout:n["a"]},data:function(){return{chartProductType:[],row_index_id:"",ui:{showYear:!1,showTaskBtns:!1,showTable:!1},tree:{dept:{data:[],props:{children:"childNodes",label:"nodeName"}},task:{data:[],props:{children:"childList",label:"class_name"}}},options:{taskType:[],taskState:[]},searchData:{class_id:"54A89E793FA24141B4C5FB13FE80AC1D",dept_id:"",task_year:"",task_type:"",task_state:"",query:"",page_number:1,page_size:10},table:{loading:!1,page:{},labels:[],data:[],result:{}},tag:{data:{}},current:{class_id:"",treeTab:"task"},dialog:{detail:{visible:!1,data:[]},progress:{visible:!1,distribution_type:"纸图",data:[]}}}},mounted:function(){this.getTree(),this.getOptions(),this.getTableData(),Object(c["f"])(this)},methods:{distributionTypeChange:function(t){this.getProgressDialogTableDate()},getTree:function(){var t=this;d["b"].getAllZuoyeshi().then((function(e){t.tree.dept.data=[e.data]})),o["d"].gettree({class_type:0}).then((function(e){t.tree.task.data=e.data}))},handleInitUI:function(){this.searchData.page_number=1,this.ui.showTable=!1,this.ui.showYear=!0,this.ui.showTaskBtns=!1},getTableData:function(t){var e=this.current.treeTab;t&&(this.handleInitUI(),"dept"===e?(this.searchData.class_id="",this.searchData.dept_id=t.nodeID):(this.searchData.class_id=t.class_id,this.searchData.dept_id="",this.current.class_id=t.class_id));var a=Object(c["e"])(this.searchData);this.ui.showYear=!0,this.ui.showTaskBtns="task"===e,"dept"===e?this.getDeptTableData(a):this.getTaskTableData(a)},getTableResult:function(t){var e=this;o["h"].getchecktaskresult(b({},t)).then((function(t){e.table.result=t.data}))},getDeptTableData:function(t){var e=this;this.ui.showTable=!0,o["h"].deptchecklist(t).then((function(t){e.table.page=t.data,e.table.data=t.data.list||[]})),this.getTableResult(t)},getTaskTableData:function(t){var e=this;this.ui.showTable=!0,this.table.loading=!0,o["h"].selectchecktask(t).then((function(t){e.table.page=t.data,e.table.data=t.data.smallList||[],e.table.loading=!1})),this.getTableResult(t)},getOptions:function(){var t=this;d["c"].getTaskType().then((function(e){t.options.taskType=e})),d["c"].getTaskState({use_type:0}).then((function(e){t.options.taskState=e}))},handleNodeClick:function(t){this.tag.data=t,this.searchData.dept_id=t.id},handleTabsClick:function(t,e){this.currentTab=t.name},handleOpenDetailDialog:function(t){var e=this;this.dialog.detail.visible=!0;var a={dept_id:t.dept_id,task_index_id:t.index_id};o["g"].select(a).then((function(t){e.dialog.detail.data=t.data}))},handleOpenProgressDialog:function(t){this.row_index_id=t.index_id,this.dialog.progress.visible=!0,this.getProgressDialogTableDate()},getProgressDialogTableDate:function(){var t=this,e={task_index_id:this.row_index_id,distribution_type:this.dialog.progress.distribution_type};o["g"].select(e).then((function(e){200==e.code?t.dialog.progress.data=e.data:Object(c["h"])(t,2,e)}))},handleChangeYear:function(t){this.searchData.task_year=t},handleQuery:function(){this.getTableData()},handleDeptTagClose:function(){this.tag.data={},this.searchData.dept_id=""},handleExport:function(){Object(c["c"])("","任务单")},handlePrint:function(){window.print()},handleTreeTabClick:function(t){},removeTableData:function(){this.table.data=[]},handleCurrentChange:function(t){this.searchData.page_number=t,this.getTableData()}}},h=u,_=(a("1db2"),a("5d22")),g=Object(_["a"])(h,l,s,!1,null,"d1a1bf3c",null);e["default"]=g.exports},5392:function(t,e,a){}}]);